---
title: "raw_data"
author: "Rom Blanco"
date: "10/22/2020"
output: html_document
---

```{r}
library(readxl)
library(dplyr)
library(janitor)
library(tidyverse)
library(ggplot2)
library(hablar)
library(reprex)
library(lubridate)

```


```{r}
crime_rate <- read.csv("Raw_Data/crimes.csv")
disease_rate <- read.csv("Raw_Data/Communicable_disease_rates.csv")
forested_area <- read.csv("Raw_Data/forest-area-km.csv")
natural_disasters <- read.csv("Raw_Data/Natural_disasters.csv")
unemployment_rate <- read_xls("Raw_Data/Labor_force.xls")
```


NATURAL DISASTERS

```{r}
# Cleaning natural_disasters data

disasters <- natural_disasters %>%
  select(-Entity) %>%
  rename(Disaster_count = Number.of.disasters..EMDAT..2020..) %>%
  mutate(Year = as.numeric(Year)) %>%
  mutate(Disaster_count = as.numeric(Disaster_count))
```


FORESTED AREA AND UNEMPLOYMENT

```{r}
# Cleaning forested_area dataset
forested <- forested_area %>%
  select(-Code) %>%
  rename(forested_area = Forest.area) %>%
  rename(Country = Entity) 

# Cleaning unemployment dataset
unemployment <- unemployment_rate %>%
  rename(Country = `Country Name`) %>%
  pivot_longer(cols = c(`1990`:`2020`), names_to = "Year", values_to = "Unemployed") %>%
  mutate(Year = as.integer(Year))

# merging forested_area and unemployment
For_v_Unemp <- forested %>%
 left_join(unemployment, by = c("Country", "Year")) %>%
  drop_na(Unemployed)
  
# plotting forested_area and unemployment
For_v_Unemp_Plot <- For_v_Unemp  %>%
  filter(Country == "Angola") %>%
  ggplot(aes(x = forested_area, y = Unemployed)) +
  geom_point() + 
  geom_smooth(method = lm) +
  theme_bw() +
  labs(title = "Forested Area vs Number of People Unemployed",
       subtitle = "Number of people unemployed decreases as forested area increases",
       x = "Forested Area (sq. km)",
       y = "Disease rate")

For_v_Unemp_Plot


# creating linear model
lmUnemp = lm(Unemployed~forested_area, data = For_v_Unemp)
summary(lmUnemp)

```


FORESTED AREA AND DISEASE RATE

```{r}
# cleaning disease_rate dataset
disease <- disease_rate %>%
  rename(disease_rate = DALYs..Disability.Adjusted.Life.Years....Communicable..maternal..neonatal..and.nutritional.diseases) %>%
  rename(Country = Entity) 

# merging forested_area and unemployment
For_v_Dis <- forested %>%
 left_join(disease, by = c("Country", "Year")) %>%
  drop_na(disease_rate)

For_v_Dis_Plot <- For_v_Dis %>%
  filter(Country == "Angola") %>%
  ggplot(aes(x = forested_area, y = disease_rate)) +
  geom_point() + 
  geom_smooth(method = "lm") +
  theme_bw() +
  labs(title = "Forested Area vs Communicable Disease Rate",
       subtitle = "Disease rate decreases as forested area increases",
       x = "Forested Area (sq. km)",
       y = "Disease rate")

For_v_Dis_Plot
```

FORESTED AREA AND CRIMES

```{r}
# cleaning crime_rate dataset
crime <- crime_rate %>%
  rename(Country = Entity, crime_rate = Deaths...Interpersonal.violence...Sex..Both...Age..All.Ages..Percent.) 

# merging forested_area and unemployment
For_v_Crime <- forested %>%
 left_join(crime, by = c("Country", "Year")) %>%
  drop_na(crime_rate)

For_v_crime_Plot <- For_v_Crime %>%
  filter(Country == "Angola") %>%
  ggplot(aes(x = forested_area, y = crime_rate)) +
  geom_point() + 
  geom_smooth(method = "lm") +
  theme_bw() +
  labs(title = "Forested Area vs Crime Rates", 
       subtitle = "Crime rate decreases as forested area increases",
       x = "Forested Area (sq. km)",
       y = "Crime rate")
  
For_v_crime_Plot
  
```

NORESTED AREA AND NATURAL DISASTERS
```{r}
# Cleaning Natural Disasters and merging it with Forested Area 
Forest_v_disasters <- forested %>%
  pivot_wider(names_from = "Country", values_from = "forested_area") %>%
  select(Year, World) %>%
  left_join(disasters, by = "Year") %>%
  select(World, Year, Disaster_count) 

# Merging Natural Disasters and Forested Area 
disasters_v_forest <- Forest_v_disasters %>% 
  ggplot(aes(x = World, y = Disaster_count)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_bw() +
  labs(title = "Forested Area vs Disaster Count Globally", 
       subtitle = "Disaster count decreases as forested area increases",
       x = "Forested Area (sq. km)",
       y = "Number of Natural Disasters")
  
disasters_v_forest

```


```{r}

```

